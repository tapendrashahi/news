# Legal Pages Management System

## Overview

The Legal Pages Management System allows administrators to create, edit, and manage legal and administrative pages such as Privacy Policy, Terms of Service, Cookie Policy, Ethics Policy, Editorial Guidelines, and About Us pages. The system is built with a flexible JSON-based content structure that adapts to different page types.

## Features

- **Dynamic JSON-Based Content**: Each legal page stores its content as a structured JSON object, allowing for complex, hierarchical content
- **Template System**: Pre-defined JSON templates for common legal pages (Privacy Policy, Terms, etc.)
- **Version Control**: Track different versions of legal pages
- **Status Management**: Draft, Published, and Archived states
- **Form Validation**: Real-time JSON validation and formatting
- **Admin Interface**: Beautiful, user-friendly admin panel for managing pages
- **Public API**: REST API endpoints for accessing published pages on the frontend

## Architecture

### Backend (Django)

**Models** (`news/legal_models.py`):
- `LegalPage`: Main model for storing legal/administrative pages
  - `page_type`: Type of page (privacy_policy, terms_of_service, etc.)
  - `title`: Page title
  - `slug`: URL-friendly identifier
  - `content_json`: JSON structure containing page content
  - `status`: Draft, Published, or Archived
  - `version`: Version number
  - `effective_date`: When the page becomes effective
  - `contact_email`: Contact email for the page
  - `meta_description`: SEO description

**Serializers** (`news/legal_serializers.py`):
- `LegalPageSerializer`: Full serializer for create/update operations
- `LegalPageListSerializer`: Lightweight serializer for list views

**Views** (`news/legal_views.py`):
- `LegalPageViewSet`: ViewSet providing CRUD operations and custom actions
  - `list()`: Get all legal pages (filtered by status for public)
  - `retrieve()`: Get a specific page
  - `create()`: Create new page (admin only)
  - `update()`: Update existing page (admin only)
  - `delete()`: Delete a page (admin only)
  - `get_by_slug()`: Get page by slug
  - `get_by_type()`: Get page by type
  - `publish()`: Publish a draft page
  - `unpublish()`: Unpublish a page
  - `archive()`: Archive a page
  - `page_types()`: Get available page types

### Frontend (React)

**Service** (`frontend/src/admin/services/legalService.js`):
- API wrapper for all legal page operations

**Components**:
- `LegalPagesList`: List view showing all legal pages with filters
- `LegalPageForm`: Create/Edit form with JSON editor and template loader

**Routes**:
- `/admin/legal` - List all legal pages
- `/admin/legal/create` - Create new page
- `/admin/legal/:id/edit` - Edit existing page

## API Endpoints

### Public Endpoints (No Authentication Required)

```
GET /api/legal/                    # List published legal pages
GET /api/legal/{id}/               # Get specific page (published only)
GET /api/legal/slug/{slug}/        # Get page by slug (published only)
GET /api/legal/type/{page_type}/   # Get page by type (published only)
```

### Admin Endpoints (Authentication Required)

```
GET    /api/admin/legal/              # List all legal pages
POST   /api/admin/legal/              # Create new page
GET    /api/admin/legal/{id}/         # Get specific page
PUT    /api/admin/legal/{id}/         # Update page
PATCH  /api/admin/legal/{id}/         # Partial update
DELETE /api/admin/legal/{id}/         # Delete page

POST   /api/admin/legal/{id}/publish/    # Publish page
POST   /api/admin/legal/{id}/unpublish/  # Unpublish page
POST   /api/admin/legal/{id}/archive/    # Archive page
GET    /api/admin/legal/page_types/      # Get available page types
```

## JSON Structure Examples

### Privacy Policy Structure

```json
{
  "metadata": {
    "title": "Privacy Policy",
    "lastUpdated": "2024-12-01",
    "effectiveDate": "2024-01-01",
    "companyName": "News Portal",
    "companyEmail": "privacy@newsportal.com",
    "companyAddress": "123 Main Street, City, State 12345"
  },
  "introduction": {
    "title": "Introduction",
    "content": [
      "Welcome to News Portal...",
      "This privacy policy applies to..."
    ]
  },
  "sections": [
    {
      "id": "information-we-collect",
      "title": "Information We Collect",
      "icon": "database",
      "content": ["We collect several types of information..."],
      "subsections": [
        {
          "title": "Personal Information",
          "items": [
            "Name and contact information",
            "Account credentials",
            "Profile information"
          ]
        }
      ]
    }
  ]
}
```

### About Us Structure

```json
{
  "hero": {
    "title": "About AI Analitica",
    "subtitle": "AI-Powered News Analysis • Unbiased • Data-Driven"
  },
  "mission": {
    "title": "Our Mission",
    "content": [
      "At AI Analitica, we leverage cutting-edge AI...",
      "Every article is generated by AI systems..."
    ]
  },
  "values": {
    "title": "Our Core Values",
    "items": [
      {
        "icon": "robot",
        "title": "AI-Powered",
        "description": "100% AI-generated analysis..."
      }
    ]
  },
  "stats": [
    {
      "value": "500K+",
      "label": "Monthly Readers"
    }
  ]
}
```

## Setup Instructions

### 1. Database Migration

```bash
# Create migration for LegalPage model
python manage.py makemigrations

# Apply migration
python manage.py migrate
```

### 2. Populate Initial Data

```bash
# Run the population script to load JSON files into database
python populate_legal_pages.py
```

This will create 6 legal pages from the JSON files in the `administration/` folder:
- Privacy Policy
- Terms of Service
- Cookie Policy
- Ethics Policy
- Editorial Guidelines
- About Us

### 3. Access Admin Interface

1. Start the backend server:
   ```bash
   python manage.py runserver
   ```

2. Start the frontend server:
   ```bash
   cd frontend
   npm start
   ```

3. Navigate to: `http://localhost:3000/admin/legal`

## Usage Guide

### Creating a New Legal Page

1. Navigate to **Legal Pages** in the admin sidebar
2. Click **Create New Page**
3. Fill in basic information:
   - **Page Type**: Select from dropdown (Privacy Policy, Terms, etc.)
   - **Title**: Display title
   - **Slug**: URL identifier (e.g., `privacy-policy`)
   - **Status**: Draft, Published, or Archived
   - **Version**: Version number (e.g., `1.0`)
   - **Effective Date**: When the page becomes effective
4. Load a template or write custom JSON:
   - Select a template from the dropdown
   - Click **Load Template** to populate the JSON editor
   - Or write/paste your own JSON structure
5. Click **Format JSON** to auto-format your JSON
6. Click **Create Page** to save

### Editing an Existing Page

1. Find the page in the list
2. Click the **Edit** button
3. Modify the fields or JSON content
4. Click **Update Page** to save changes

### Publishing/Unpublishing Pages

- **Publish**: Click the **Publish** button on a draft page
- **Unpublish**: Click the **Unpublish** button on a published page
- **Archive**: Click **Archive** to move to archived status

### Using Templates

The system includes pre-loaded JSON templates from the `administration/` folder:

- `privacy_polity.json` → Privacy Policy template
- `terms_of_service.json` → Terms of Service template
- `cookee.json` → Cookie Policy template
- `ethics_policy.json` → Ethics Policy template
- `guidemines.json` → Editorial Guidelines template
- `about.json` → About Us template

To use a template:
1. Select the template from the dropdown
2. Click **Load Template**
3. The JSON editor will be populated with the template structure
4. Modify as needed

## JSON Validation

The form includes real-time JSON validation:
- **Valid JSON**: Green border, no errors
- **Invalid JSON**: Red border with error message
- **Format Button**: Auto-formats valid JSON with proper indentation

## Filtering and Search

The list view includes filters:
- **All Pages**: Show all legal pages
- **Published**: Show only published pages
- **Drafts**: Show only draft pages
- **Archived**: Show only archived pages

## Admin Permissions

- **Public Access**: Can view published pages only
- **Admin Access**: Full CRUD operations, can manage all statuses

## Database Schema

```sql
CREATE TABLE news_legalpage (
    id SERIAL PRIMARY KEY,
    page_type VARCHAR(50) UNIQUE NOT NULL,
    title VARCHAR(255) NOT NULL,
    slug VARCHAR(255) UNIQUE NOT NULL,
    content_json JSONB NOT NULL,
    status VARCHAR(20) DEFAULT 'draft',
    version VARCHAR(20) DEFAULT '1.0',
    effective_date DATE NOT NULL,
    last_updated TIMESTAMP NOT NULL,
    created_at TIMESTAMP NOT NULL,
    meta_description TEXT,
    contact_email VARCHAR(254)
);
```

## File Structure

```
news/
├── legal_models.py          # LegalPage model
├── legal_serializers.py     # Serializers for API
├── legal_views.py           # ViewSet for API endpoints
├── migrations/
│   └── 0014_legalpage.py    # Migration file
└── admin.py                 # Django admin registration

frontend/src/admin/
├── services/
│   └── legalService.js      # API service
├── pages/legal/
│   ├── LegalPagesList.jsx   # List component
│   ├── LegalPageForm.jsx    # Create/Edit form
│   ├── LegalPages.css       # List styles
│   └── LegalPageForm.css    # Form styles

administration/              # JSON template files
├── privacy_polity.json
├── terms_of_service.json
├── cookee.json
├── ethics_policy.json
├── guidemines.json
└── about.json

populate_legal_pages.py      # Data population script
```

## Best Practices

1. **Version Control**: Increment version numbers when making significant changes
2. **Effective Dates**: Set appropriate effective dates for legal changes
3. **JSON Validation**: Always validate JSON before saving
4. **Templates**: Use templates as starting points, customize as needed
5. **Status Management**: Keep drafts until reviewed, then publish
6. **Backups**: Export JSON content before major updates

## Troubleshooting

**JSON Parse Errors**:
- Use the **Format JSON** button to check for syntax errors
- Ensure all quotes are properly closed
- Check for trailing commas

**Template Not Loading**:
- Verify the JSON file exists in `administration/` folder
- Check file permissions
- Look for JSON syntax errors in the template file

**Page Not Appearing**:
- Check the status (only published pages appear publicly)
- Verify effective date is not in the future
- Check permissions (admin vs public access)

## Future Enhancements

- [ ] Visual JSON editor with form fields
- [ ] Version history and rollback
- [ ] Preview before publish
- [ ] Multi-language support
- [ ] Content comparison between versions
- [ ] Scheduled publishing
- [ ] Email notifications on updates

## Support

For issues or questions:
- Check the JSON structure examples above
- Review the administration folder templates
- Contact the development team

---

**Last Updated**: December 8, 2025  
**Version**: 1.0
