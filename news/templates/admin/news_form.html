{% extends 'admin/base.html' %}

{% block title %}{% if is_edit %}Edit{% else %}Create{% endif %} News Article{% endblock %}
{% block page_title %}{% if is_edit %}Edit{% else %}Create New{% endif %} Article{% endblock %}

{% block content %}
<div class="table-card" style="max-width: 1000px; margin: 0 auto;">
    <div class="table-header">
        <div>
            <h3>
                <i class="fas fa-{% if is_edit %}edit{% else %}plus-circle{% endif %}"></i> 
                {% if is_edit %}Edit{% else %}Create New{% endif %} Article
            </h3>
            <p style="color: #6c757d; font-size: 13px; margin-top: 4px;">
                {% if is_edit %}Update article details and content{% else %}Add a new article to your news portal{% endif %}
            </p>
        </div>
        <a href="{% url 'custom_admin:news_list' %}" class="btn btn-sm" style="background: #6c757d; color: white;">
            <i class="fas fa-arrow-left"></i> Back to List
        </a>
    </div>

    <div class="form-container">
        <form method="post" enctype="multipart/form-data" class="admin-form">
            {% csrf_token %}

            <!-- Basic Information Section -->
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-info-circle"></i> Basic Information
                </h4>
                
                <div class="form-group">
                    <label><i class="fas fa-heading"></i> Article Title *</label>
                    <input type="text" name="title" class="form-control" value="{{ news.title }}" 
                           placeholder="Enter an engaging title for your article..." required>
                    <small class="form-text">Keep it clear and compelling</small>
                </div>

                <div class="form-group">
                    <label><i class="fas fa-align-left"></i> Article Content *</label>
                    <textarea name="content" class="form-control" rows="28" 
                              placeholder="Write your article content here..." required>{{ news.content }}</textarea>
                    <small class="form-text">Use clear paragraphs and formatting for better readability</small>
                </div>
            </div>

            <!-- Classification Section -->
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-folder-open"></i> Classification
                </h4>
                
                <div class="form-row">
                    <div class="form-group">
                        <label><i class="fas fa-tag"></i> Category *</label>
                        <select name="category" class="form-control" required>
                            <option value="">Select a category...</option>
                            {% for cat_code, cat_name in categories %}
                            <option value="{{ cat_code }}" {% if news.category == cat_code %}selected{% endif %}>{{ cat_name }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-user-edit"></i> Author</label>
                        <select name="author" class="form-control">
                            <option value="">No Author (Optional)</option>
                            {% for member in team_members %}
                            <option value="{{ member.id }}" {% if news.author_id == member.id %}selected{% endif %}>
                                {{ member.name }} - {{ member.get_role_display }}
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>

            <!-- Media Section -->
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-image"></i> Featured Image
                </h4>
                
                <div class="form-group">
                    <label><i class="fas fa-upload"></i> Upload Image</label>
                    <input type="file" name="image" class="form-control file-input" accept="image/*">
                    {% if news.image %}
                    <div class="image-preview">
                        <p class="preview-label">
                            <i class="fas fa-check-circle"></i> Current Image:
                        </p>
                        <img src="{{ news.image.url }}" alt="Current image" class="preview-img">
                        <p class="preview-note">
                            <i class="fas fa-info-circle"></i> Upload a new image to replace the current one
                        </p>
                    </div>
                    {% else %}
                    <small class="form-text">
                        <i class="fas fa-info-circle"></i> Recommended size: 1200x630px for best display
                    </small>
                    {% endif %}
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary btn-lg">
                    <i class="fas fa-{% if is_edit %}save{% else %}plus-circle{% endif %}"></i> 
                    {% if is_edit %}Update{% else %}Publish{% endif %} Article
                </button>
                <a href="{% url 'custom_admin:news_list' %}" class="btn btn-secondary btn-lg">
                    <i class="fas fa-times"></i> Cancel
                </a>
            </div>
        </form>
    </div>
</div>
{% endblock %}
