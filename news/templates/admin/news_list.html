{% extends 'admin/base.html' %}

{% block title %}News Articles{% endblock %}
{% block page_title %}News Articles Management{% endblock %}

{% block content %}
<div class="table-card">
    <div class="table-header">
        <div>
            <h3><i class="fas fa-newspaper"></i> All Articles ({{ news_list.count }})</h3>
            <p style="color: #6c757d; font-size: 13px; margin-top: 4px;">Manage all your published content</p>
        </div>
        <a href="{% url 'custom_admin:news_create' %}" class="btn btn-primary">
            <i class="fas fa-plus"></i> Add New Article
        </a>
    </div>

    <!-- Filters -->
    <div style="padding: 24px 28px; border-bottom: 2px solid #f1f3f5; background: linear-gradient(135deg, rgba(102, 126, 234, 0.03) 0%, rgba(118, 75, 162, 0.03) 100%);">
        <form method="get" style="display: flex; gap: 16px; align-items: end; flex-wrap: wrap;">
            <div class="form-group" style="margin: 0; flex: 1; min-width: 280px;">
                <label><i class="fas fa-search"></i> Search Articles</label>
                <input type="text" name="search" class="form-control" placeholder="Search by title or content..." value="{{ search }}">
            </div>
            <div class="form-group" style="margin: 0; min-width: 200px;">
                <label><i class="fas fa-filter"></i> Filter by Category</label>
                <select name="category" class="form-control">
                    <option value="">All Categories</option>
                    {% for cat_code, cat_name in categories %}
                    <option value="{{ cat_code }}" {% if category == cat_code %}selected{% endif %}>{{ cat_name }}</option>
                    {% endfor %}
                </select>
            </div>
            <button type="submit" class="btn btn-primary" style="margin-bottom: 0;">
                <i class="fas fa-search"></i> Apply Filters
            </button>
            {% if search or category %}
            <a href="{% url 'custom_admin:news_list' %}" class="btn btn-sm" style="background: #6c757d; color: white; margin-bottom: 0;">
                <i class="fas fa-times"></i> Clear
            </a>
            {% endif %}
        </form>
    </div>

    <table>
        <thead>
            <tr>
                <th style="width: 60px;">ID</th>
                <th>Title</th>
                <th style="width: 150px;">Category</th>
                <th style="width: 150px;">Author</th>
                <th style="width: 120px;">Published</th>
                <th style="width: 180px; text-align: center;">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for news in news_list %}
            <tr>
                <td style="font-weight: 700; color: #667eea;">#{{ news.id }}</td>
                <td style="font-weight: 600;">
                    <i class="fas fa-file-alt" style="color: #667eea; margin-right: 8px;"></i>
                    {{ news.title|truncatewords:10 }}
                </td>
                <td><span class="badge badge-info">{{ news.get_category_display }}</span></td>
                <td style="color: #6c757d;">
                    <i class="fas fa-user" style="margin-right: 6px;"></i>
                    {{ news.author.name|default:"No Author" }}
                </td>
                <td style="color: #6c757d; font-size: 13px;">
                    <i class="fas fa-calendar" style="margin-right: 6px;"></i>
                    {{ news.created_at|date:"M d, Y" }}
                </td>
                <td style="text-align: center;">
                    <div style="display: flex; gap: 8px; justify-content: center;">
                        <a href="/news/{{ news.id }}/" target="_blank" class="btn btn-sm" style="background: linear-gradient(135deg, #17a2b8 0%, #138496 100%); color: white;" title="View Article">
                            <i class="fas fa-eye"></i>
                        </a>
                        <a href="{% url 'custom_admin:news_edit' news.id %}" class="btn btn-sm btn-primary" title="Edit Article">
                            <i class="fas fa-edit"></i>
                        </a>
                        <a href="{% url 'custom_admin:news_delete' news.id %}" class="btn btn-sm btn-danger" 
                           onclick="return confirm('Are you sure you want to delete this article?')" title="Delete Article">
                            <i class="fas fa-trash"></i>
                        </a>
                    </div>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="6" style="text-align: center; padding: 60px; color: #999;">
                    <i class="fas fa-inbox" style="font-size: 60px; display: block; margin-bottom: 20px; opacity: 0.2;"></i>
                    <h3 style="font-size: 18px; margin-bottom: 12px; color: #6c757d;">No articles found</h3>
                    <a href="{% url 'custom_admin:news_create' %}" class="btn btn-primary" style="margin-top: 16px;">
                        <i class="fas fa-plus"></i> Create your first article
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
